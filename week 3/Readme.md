# Section 1: Pre-Layout Simulation of a 3-Stage-Ring-Oscillator

## Basics of Ring Oscillator

A Ring Oscillator(RO), shown in fig.1, is a device composed of an odd number of NOT gates in a ring, whose output oscillates between two voltage levels, representing true and false. The NOT gates, or inverters, are attached in a chain and the output of the last inverter is fed back into the first. If t represents the time delay for a single inverter and n represents the number of inverters in the inverter chain, then the frequency of oscillation is as (1).



$$
 f={\frac {1}{2tn}}       \tag{1}
$$

<br>

<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/222668574-94dc19f1-36d1-42e0-adf8-6baf5ed02933.png"  style="width:50%"/>
    <br>
    <em>Fig.1. A-three-stage-ring-oscillator.</em>
</p>

# Section 2: Pre_Layout Simulation of a 3-Stage-Ring-Oscillator


Fig.2.(a) shows the circuit implemented in the Xschem and fig.2.(b) shows the circuit under test. 
<p  align="center">
 <img src="https://user-images.githubusercontent.com/38715276/222711559-47aefa18-ed44-43bc-a190-b3c45e106b40.png"  style="height:250px" style="width:40%" />
 &nbsp; &nbsp; &nbsp; &nbsp;
 <img src="https://user-images.githubusercontent.com/38715276/222712195-4539b398-a9f3-4bbe-824b-6a5bb5f33225.png"  style="height:250px" style="width:40%" />
    <br>
    <em>Fig.2.(a) Ring oscillator schematic, (b) Ring Oscillator under test.</em>
</p>
<br>


the output is shown in fig.3
<p  align="center">
 <img src="https://user-images.githubusercontent.com/38715276/222729541-20c151b9-a71c-4704-9054-2fbab904907c.png"   style="width:70%" />
    <br>
    <em>Fig.3. Ring oscillator output.</em>
</p>
<br>
<br>
where the period as shown in fig.4 with a red square around that is 0.5ns.
<p  align="center">
 <img src="https://user-images.githubusercontent.com/38715276/222733279-c96b7f2a-d672-4f5e-b65f-3a6e4d4b2182.png"   style="width:70%" />
    <br>
    <em>Fig.3. period calculation for pre-layout simulation of RO.</em>
</p>

# Section 3: Post_Layout Simulation of a 3-Stage-Ring-Oscillator

To generate the layout Align tool is utilised.
the netlist fed to the Align is:

```
.subckt my_RO A VP Y VN

XM1 1 A  VN VN sky130_fd_pr__nfet_01v8 l=150e-9 w=420e-9 nf=2
XM2 1 A  VP VP sky130_fd_pr__pfet_01v8 l=150e-9 w=420e-9 nf=2
XM3 2 1 VN VN sky130_fd_pr__nfet_01v8 l=150e-9 w=420e-9 nf=2
XM4 2 1 VP VP sky130_fd_pr__pfet_01v8 l=150e-9 w=420e-9 nf=2
XM5 Y 2 VN VN sky130_fd_pr__nfet_01v8 l=150e-9 w=420e-9 nf=2
XM6 Y 2 VP VP sky130_fd_pr__pfet_01v8 l=150e-9 w=420e-9 nf=2
.ends
```

and the generated gds and lef files by Align is depicted in fig.4.(a) and (b), respectively.

<p  align="center">
 <img src=""  style="height:250px" style="width:40%" />
 &nbsp; &nbsp; &nbsp; &nbsp;
 <img src="https://user-images.githubusercontent.com/38715276/222738984-7c2d0c86-e911-4d27-a808-802ccdf1eee1.png"  style="height:250px" style="width:40%" />
    <br>
    <em>Fig.4. files generated by Align:(a) gds, (b) lef.</em>
</p>
<br>
By feeding gds file into magic tool,  and uusing commands below

```
extract all
ext2spice scale off 
ext2spice cthresh 0 rthresh 0
ext2spice
```

parasitic capacitances can be extracted from the generated netlist as below:


```
C0 A 1 0.35fF
C1 Y 2 0.13fF
C2 Y 1 0.00fF
C3 A 2 0.00fF
C4 Y VP 0.70fF
C5 2 VP 0.92fF
C6 A 2 0.01fF
C7 VP VP 0.00fF
C8 2 1 0.18fF
C9 A VP 0.55fF
C10 VP 1 1.57fF
C11 Y VP 0.40fF
C12 A VN 0.01fF
C13 Y VP 0.00fF
C14 VP VN 0.94fF
C15 2 VP 1.72fF
C16 Y 1 0.00fF
C17 VN 1 0.26fF
C18 Y VP 0.00fF
C19 VP VN 0.28fF
C20 A VN 1.45fF 
C21 2 VN 2.98fF
C22 1 VN 2.37fF
C23 VP VN 9.43fF
C24 Y VN 0.80fF
```


the oscillation of RO with paracitics capacitances is shown in fig.5.
<p  align="center">
 <img src=""   style="width:70%" />
    <br>
    <em>Fig.5. Post-layout output of RO.</em>
</p>

where the period as shown in fig.6 with a red square around that is 2.2ns.

<p  align="center">
 <img src=""   style="width:70%" />
    <br>
    <em>Fig.6. The period calculation for post-layout simulation of RO.</em>
</p>

# Section 4: Comparison Between Post_Layout and Pre-layout

|      |  Pre-layout | Post-layout |
| --- | --- | --- |
| Period | &nbsp;&nbsp;&nbsp;  0.5ns | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   2.2ns |

From table above, the role of parasitic capacitances on period of RO is obvious.
