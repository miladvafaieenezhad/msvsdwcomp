# Section 1: Basics of Analogue to Digital Converter
An analog-to-digital converter (ADC, A/D or A-to-D) is an electronic integrated circuit that converts a continuous quantity to a discrete time digital number. An ADC may also provide an isolated measurement. The reverse operation is performed by a digital-to-analog converter (DAC). The conceptual model of ADC is shown in fig.1.[1]

<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224112135-07998ed8-ec7b-44ab-8c4e-daea9c20553e.png"  style="width:30%"/>
    <br>
    <em>Fig.1. Conceptual model of ADC.</em>
</p>

# Section 2: 1-Bit ADC

An analogue comparator such as the LM339N which has two analogue inputs, one positive and one negative, and which can be used to compare the magnitudes of two different voltage levels. A voltage input, (VIN) signal is applied to one input of the comparator, while a reference voltage, (VREF) to the other. A comparison of the two voltage levels at the comparator’s input is made to determine the comparators digital logic output state, either a “1” or a “0”. <br>
The reference voltage, VREF is compared against the input voltage, VIN applied to the other input. For an LM339 comparator, if the input voltage is less than the reference voltage, (VIN < VREF) the output is “OFF”, and if it is greater than the reference voltage, (VIN > VREF) the output will be “ON”. Thus a comparator compares two voltage levels and determines which one of the two is higher. Fig.2 shows an analogue comparator(1-bit ADC):

<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224158649-8a137478-7807-42ee-a6cd-ec0bbd20e58f.png"  style="width:20%"/>
    <br>
    <em>Fig.2. An 1-bit ADC.</em>
</p>

in which the opamp structure is shown in fig.3.

<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224251713-1fed14d7-c6e0-4cd0-b37c-bdc9680b15c6.png"  style="width:30%"/>
    <br>
    <em>Fig.3. A simple opamp.[2]</em>
</p>


# Section 3: Pre-Layout Simulation of a 1-Bit ADC
The schematic of pre-layout simulation in Xschem in shwon in fig.4.
<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224172133-877fd306-a6a9-4bca-adcd-15d6f4bfa843.png"/>
    <br>
    <em>Fig.4. The schematic of pre-layout simulation in Xschem.</em>
</p>

The input and outout of 1-bit ADC is depicted in fig.5.

<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224161566-72b37135-e546-4966-abcf-f27f45802161.png"  style="width:50%"  style="width:50%"/>
    <br>
    <em>Fig.5. The pre-layout's input and outout of 1-bit ADC.</em>
</p>

The delay of pre-layout implementation equals 0.9ns as illustrated in fig.6.

<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224167391-46434ba2-b485-4148-a910-e9da954e0308.png"  style="width:50%"/>
    <br>
    <em>Fig.6. The delay of pre-layout simulation.</em>
</p>

Prelayout simulation files can be found [here](https://github.com/miladvafaieenezhad/msvsdwcomp/tree/main/week%204/sim/1).

# Section 4: Post-Layout Simulation of a 1-Bit ADC
By using Align the generated [.gds and .lef](https://github.com/miladvafaieenezhad/msvsdwcomp/tree/main/week%204/sim/2) files for the 1-bit ADC is as fig.7.
 
<p  align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224170793-fcf27ad5-53f9-48ba-b69c-baadae700767.png"  style="height:250px" style="width:40%" />
    <br>
    <em>Fig.7. Files generated by Align: (a) gds and (b) lef.</em>
</p>

After importing .gds file into Magic and [extraction of parasitic capacitances](https://github.com/miladvafaieenezhad/msvsdwcomp/tree/main/week%204/sim/3), the post-layout result is as fig.8

 <p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224161988-9e38be06-aba8-4f8e-aefe-90a87040ed68.png"  style="width:50%"/>
    <br>
    <em>Fig.8. The post-layout simulation result.</em>
</p>

for which the delay equals 19ns as is illustrated in fig.9.

 <p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224168577-7702ae3f-d317-49ca-8d19-a4176f79ca70.png"  style="width:50%"/>
    <br>
    <em>Fig.9. The delay of post-layout simulation.</em>
</p>

Post layout simulation files can be found [here](https://github.com/miladvafaieenezhad/msvsdwcomp/tree/main/week%204/sim/4).

 # Section 5: Comparison Between Post-Layout and Pre-Layout Results
 
 <div align="center">
 
 <em>Table I. Comparison of pre and post-layout results of ADC.</em>
|      |  Pre-layout | Post-layout |
| :---: | :---: | :---: |
| Period |  0.9ns | 1.9ns |
</div>

From table I, the role of parasitic capacitances on delay of the ADC is obvious.

 # Section 6: Pre-Layout simulation of RO_ADC
 
 To ensure that the designed RO in the last week is compatible with the our ADC, the output of RO is connected to ADC to make RO_ADC. The schematic is shown in fig.10. 
 
<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224537367-11509898-b19b-4a83-8614-bb2415e16653.png"  style="width:50%"/>
    <br>
    <em>Fig.10. The schematic of RO_ADC.</em>
</p>


After changing the sizing of ADC to increase the ADC operating frequency point, as depicted in fig.11 the RO_ADC works properly.
<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224537402-dd11936c-7530-4a58-9436-39e4e406c785.png"  style="width:50%"/>
    <br>
    <em>Fig.11. The output of RO_ADC.</em>
</p>

# Section 7: Post-Layout simulation of RO_ADC

To consider the effects of parasitic capacitances on RO_ADC, by using align and magic as discussed in previous weeks, the result of post-layout simulation is illustrated in fig.12.
<p align="center">
 <img src="https://user-images.githubusercontent.com/38715276/224537854-1ab614cd-2baa-4b6e-b3b8-103ae3e227cd.png"  style="width:50%"/>
    <br>
    <em>Fig.11. The output of RO_ADC.</em>
</p>
The result in comparison with pre-layut simulation shows that speed seems to be decreased. in the next section two post and pre-layout simulations will be compared.


# Section 8: Comparison of Pre and Post-Layout results of RO_ADC

Table II summerizes the pre and post-layout results. as shown, the period of RO in increases from 0.7ns to 2.6ns, and also the delay of ADC increases from 68ps to 173ps. These changes are resulted because of exictance of parasitic capasitances in post-layout simulation.

 <div align="center">
 
 <em>Table II. Comparison of pre and post-layout results of RO_ADC.</em>
|      |  Pre-layout | Post-layout |
| :---: | :---: | :---: |
 | Period of RO |  0.7ns | 2.6ns |
| Delay of ADC |  68ps | 173ps |<br>

</div>


 # Section 9: Top Module of Verilog Code for RO and ADC
 
 ```
 module  analogue_async_up_down
(
input in_RO,
input in_Vref

output out_ADC
);

wire RO_ADC;

RO RO_0(
.in(in_RO),
.out(out_ADC)
);

ADC ADC_0(
.in(RO_ADC),
.in(in_Vref),
.out(out_ADC)
);

endmodule
 ```


# References
[1] R. Jacob Baker, "Data converter fundamentals" in CMOS circuits design, layout, and simulations, , Hoboken, New Jersey, USA: A JOHN WILEY & SONS, INC, 2010, pp. 930-970. <br>
[2] A. Kamath, Z. Chen, N. Shen, N. Singh, G. Q. Lo, D. L. Kwong,D. Kasprowicz, A. Pfitzner and W. Maly, “Realizing AND and ORFunctions With Single Vertical-Slit Field-Effect Transistor,” in IEEEElectron Device Letters, vol. 33, no. 2, pp. 152-154, Feb. 2012. doi:10.1109/LED.2011.2176309
